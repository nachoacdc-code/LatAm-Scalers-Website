---
import ContactForm from './ContactForm.astro';
import CalendlyInline from './CalendlyInline.astro';
import { BOOKING_URL, isExternalUrl } from '../lib/cta';

export type Props = {
	role: string;
	category: 'aec' | 'design' | 'marketing';
	hubHref: string;
	hubLabel: string;
	h1: string;
	subheadline: string;
	atAGlance: { label: string; value: string }[];
	overview: string;
	skills: string[];
	whyRemote: string;
	engagementOptions: { title: string; description: string; pricing?: string }[];
	tools: { name: string; description: string }[];
	deliverables: string[];
	pricing: string;
	relatedRoles: { title: string; href: string; category: string }[];
	faq: { question: string; answer: string }[];
};

const {
	role,
	category,
	hubHref,
	hubLabel,
	h1,
	subheadline,
	atAGlance,
	overview,
	skills,
	whyRemote,
	engagementOptions,
	tools,
	deliverables,
	pricing,
	relatedRoles,
	faq,
} = Astro.props;

const bookingUrl = BOOKING_URL;
const bookingExternal = isExternalUrl(bookingUrl);
const calendlyUrl = import.meta.env.PUBLIC_CALENDLY_URL ?? 'https://calendly.com/your-org/15min';

const categoryLabels: Record<string, string> = {
	aec: 'AEC',
	design: 'Design',
	marketing: 'Marketing',
};

const categoryColors: Record<string, string> = {
	aec: 'text-aec',
	design: 'text-design',
	marketing: 'text-marketing',
};

const defaultInterest = category === 'aec' ? 'aec' : category === 'design' ? 'design' : 'marketing';
---

{/* 1. HERO */}
<section class="relative overflow-hidden bg-slate-950 py-16 sm:py-24" aria-labelledby="role-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="grid items-center gap-10 lg:grid-cols-2">
			<div class="js-fade-in">
				<p class={`text-sm font-semibold uppercase tracking-widest ${categoryColors[category]}`}>
					{categoryLabels[category]} Role
				</p>
				<h1 id="role-heading" class="mt-4 text-4xl font-semibold leading-tight tracking-tight text-white sm:text-5xl lg:text-[3.25rem]">
					{h1}
				</h1>
				<p class="mt-5 max-w-xl text-base leading-relaxed text-slate-300 sm:text-lg">
					{subheadline}
				</p>
				<div class="mt-8 flex flex-wrap gap-3">
					<a
						href={bookingUrl}
						{...(bookingExternal ? { target: '_blank', rel: 'noreferrer' } : {})}
						class="inline-flex min-h-[48px] items-center justify-center rounded bg-sky-600 px-6 py-3 text-sm font-semibold text-white transition hover:bg-sky-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
						data-book-call
					>
						Hire a {role}
					</a>
					<a
						href="/#contact"
						class="inline-flex min-h-[48px] items-center justify-center rounded-xl border border-slate-700 bg-slate-900/40 px-6 py-3 text-sm font-semibold text-white transition hover:bg-slate-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
						data-open-tell-us="role-hero"
						data-role={role}
					>
						Tell Us Your Needs
					</a>
				</div>
			</div>

			{/* 2. AT A GLANCE */}
			<div class="js-fade-in relative">
				<div class="rounded-2xl border border-slate-800 bg-slate-900/40 p-6 shadow-lg shadow-black/20">
					<p class="text-xs font-semibold uppercase tracking-wide text-slate-400">At a glance</p>
					<ul class="mt-4 grid gap-3 sm:grid-cols-2">
						{atAGlance.map((item) => (
							<li class="rounded-xl border border-slate-800 bg-slate-950/40 p-4">
								<p class="text-xs font-semibold uppercase tracking-wide text-slate-400">{item.label}</p>
								<p class="mt-2 text-sm text-slate-200">{item.value}</p>
							</li>
						))}
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>

{/* 3. OVERVIEW */}
<section class="bg-slate-900/40 py-14 sm:py-16" aria-labelledby="overview-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="overview-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Role Overview</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				{overview}
			</p>
		</div>
		{skills.length > 0 && (
			<ul class="mt-8 grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
				{skills.map((skill) => (
					<li class="js-fade-in flex items-start gap-2 rounded-xl border border-slate-800 bg-slate-900/40 p-4">
						<span class={`shrink-0 font-bold ${categoryColors[category]}`} aria-hidden="true">âœ“</span>
						<span class="text-sm text-slate-300">{skill}</span>
					</li>
				))}
			</ul>
		)}
	</div>
</section>

{/* 4. WHY REMOTE LATAM */}
<section class="bg-slate-950 py-14 sm:py-16" aria-labelledby="why-remote-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="why-remote-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Why Hire a Remote {role} from LATAM?</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				{whyRemote}
			</p>
		</div>
		<ul class="mt-8 grid gap-3 sm:grid-cols-2 lg:grid-cols-4">
			<li class="js-fade-in rounded-xl border border-slate-800 bg-slate-900/40 px-5 py-4 text-sm text-slate-300">
				<strong class="block text-slate-100">50â€“70% cost savings</strong>
				vs. equivalent US-based hires
			</li>
			<li class="js-fade-in rounded-xl border border-slate-800 bg-slate-900/40 px-5 py-4 text-sm text-slate-300">
				<strong class="block text-slate-100">Timezone-aligned</strong>
				EST / CST / PST overlap for real-time collaboration
			</li>
			<li class="js-fade-in rounded-xl border border-slate-800 bg-slate-900/40 px-5 py-4 text-sm text-slate-300">
				<strong class="block text-slate-100">Fluent English</strong>
				pre-vetted for communication, tools, and culture
			</li>
			<li class="js-fade-in rounded-xl border border-slate-800 bg-slate-900/40 px-5 py-4 text-sm text-slate-300">
				<strong class="block text-slate-100">Month-to-month</strong>
				scale up or down anytime, no long-term contracts
			</li>
		</ul>
	</div>
</section>

{/* 5. ENGAGEMENT OPTIONS */}
<section class="bg-slate-900/40 py-14 sm:py-16" aria-labelledby="engagement-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="engagement-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Engagement Options</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Flexible arrangements to fit your capacity needs â€” dedicated individuals or scalable team setups.
			</p>
		</div>
		<div class="mt-8 grid gap-5 md:grid-cols-2">
			{engagementOptions.map((opt) => (
				<div class="js-fade-in rounded-2xl border border-slate-800 bg-slate-900/40 p-6 shadow-lg shadow-black/20">
					<h3 class="text-base font-semibold text-slate-100">{opt.title}</h3>
					<p class="mt-3 text-sm leading-relaxed text-slate-400">{opt.description}</p>
					{opt.pricing && <p class={`mt-4 text-sm font-semibold ${categoryColors[category]}`}>{opt.pricing}</p>}
				</div>
			))}
		</div>
		<div class="js-fade-in mt-6">
			<a
				href={hubHref}
				class={`inline-flex items-center gap-1.5 text-sm font-semibold ${categoryColors[category]} transition hover:opacity-80 focus:outline-none focus-visible:underline`}
			>
				View {hubLabel} engagement details <span aria-hidden="true">&rarr;</span>
			</a>
		</div>
	</div>
</section>

{/* 6. TOOLS */}
<section class="bg-slate-950 py-14 sm:py-16" aria-labelledby="tools-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="tools-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Tools & Technologies</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Specialists are vetted on the tools your team already uses.
			</p>
		</div>
		<div class="mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
			{tools.map((tool) => (
				<div class="js-fade-in rounded-2xl border border-slate-800 bg-slate-900/40 p-5 shadow-lg shadow-black/20">
					<p class="text-sm font-semibold text-slate-100">{tool.name}</p>
					<p class="mt-2 text-sm leading-relaxed text-slate-400">{tool.description}</p>
				</div>
			))}
		</div>
	</div>
</section>

{/* 7. SAMPLE DELIVERABLES */}
<section class="bg-slate-900/40 py-14 sm:py-16" aria-labelledby="deliverables-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="deliverables-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Sample Deliverables</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Typical outputs produced by a dedicated {role} for US teams.
			</p>
		</div>
		<ul class="mt-8 grid gap-3 sm:grid-cols-2">
			{deliverables.map((d) => (
				<li class="js-fade-in flex items-start gap-3 rounded-xl border border-slate-800 bg-slate-900/40 px-4 py-3">
					<span class={`mt-0.5 shrink-0 text-sm font-bold ${categoryColors[category]}`} aria-hidden="true">âœ“</span>
					<span class="text-sm text-slate-300">{d}</span>
				</li>
			))}
		</ul>
	</div>
</section>

{/* 8. PRICING GUIDANCE */}
<section class="bg-slate-950 py-14 sm:py-16" aria-labelledby="pricing-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="pricing-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Pricing Guidance</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				{pricing}
			</p>
			<p class="mt-3 text-sm text-slate-400">
				Final pricing depends on experience level, hours per week, and engagement model.
			</p>
			<div class="mt-6 flex flex-wrap gap-3">
				<a
					href={bookingUrl}
					{...(bookingExternal ? { target: '_blank', rel: 'noreferrer' } : {})}
					class="inline-flex min-h-[48px] items-center justify-center rounded bg-sky-600 px-6 py-3 text-sm font-semibold text-white transition hover:bg-sky-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
					data-book-call
				>
					Get a Custom Quote
				</a>
				<a
					href="/how-pricing-works/"
					class="inline-flex min-h-[48px] items-center justify-center rounded-xl border border-slate-700 bg-slate-900/40 px-6 py-3 text-sm font-semibold text-slate-100 transition hover:bg-slate-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
				>
					How Pricing Works
				</a>
			</div>
		</div>
	</div>
</section>

{/* 9. RELATED ROLES */}
<section class="bg-slate-900/40 py-14 sm:py-16" aria-labelledby="related-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="related-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Related Roles</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Often paired with or complementary to the {role} role.
			</p>
		</div>
		<div class="mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
			{relatedRoles.map((r) => (
				<a
					href={r.href}
					class="js-fade-in group rounded-xl border border-slate-800 bg-slate-900/40 p-5 transition hover:bg-slate-900 hover:-translate-y-0.5 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300"
				>
					<span class={`text-xs font-semibold uppercase tracking-wide ${categoryColors[r.category as keyof typeof categoryColors] ?? 'text-slate-400'}`}>
						{categoryLabels[r.category as keyof typeof categoryLabels] ?? r.category}
					</span>
					<p class="mt-2 text-sm font-semibold text-slate-100 transition-colors group-hover:text-sky-200">{r.title}</p>
					<p class="mt-2 text-sm font-semibold text-sky-300">View role &rarr;</p>
				</a>
			))}
		</div>
	</div>
</section>

{/* 10. FAQ */}
<section class="bg-slate-950 py-14 sm:py-16" aria-labelledby="faq-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<h2 id="faq-heading" class="text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">Frequently Asked Questions</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Common questions about hiring a {role} through LatAm Scalers.
			</p>
		</div>
		<div class="mt-8 grid gap-3">
			{faq.map((item) => (
				<details class="js-fade-in rounded-xl border border-slate-800 bg-slate-900/40 p-5">
					<summary class="cursor-pointer list-none text-sm font-semibold text-slate-100 [&::-webkit-details-marker]:hidden">
						{item.question}
					</summary>
					<p class="mt-4 border-t border-slate-800 pt-4 text-sm leading-relaxed text-slate-400">{item.answer}</p>
				</details>
			))}
		</div>
	</div>
</section>

{/* 11. CTA */}
<section class="bg-slate-900/40 py-14 sm:py-16" aria-labelledby="cta-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in rounded-2xl border border-slate-800 bg-slate-900/40 p-8 text-center shadow-xl sm:p-12">
			<h2 id="cta-heading" class="text-3xl font-semibold tracking-tight text-white sm:text-4xl">
				Ready to Hire a {role}?
			</h2>
			<p class="mx-auto mt-4 max-w-xl text-base leading-relaxed text-slate-300">
				Tell us your requirements and we'll present vetted {role} candidates â€” matched in under one week. Month-to-month, free replacement guarantee.
			</p>
			<div class="mt-8 flex flex-wrap items-center justify-center gap-4">
				<a
					href={bookingUrl}
					{...(bookingExternal ? { target: '_blank', rel: 'noreferrer' } : {})}
					class="inline-flex min-h-[48px] items-center justify-center rounded bg-sky-600 px-8 py-3 text-sm font-semibold text-white transition hover:bg-sky-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
					data-book-call
				>
					Book a 15-Min Call
				</a>
				<a
					href="/roles/"
					class="inline-flex min-h-[48px] items-center justify-center rounded-xl border border-slate-700 bg-slate-900/40 px-8 py-3 text-sm font-semibold text-white transition hover:bg-slate-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-300 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
				>
					Browse All Roles
				</a>
			</div>
			<p class="mt-5 text-xs text-slate-400">Month-to-month Â· Free replacement guarantee Â· No long-term contracts</p>
		</div>
	</div>
</section>

{/* CONTACT + CALENDLY */}
<section class="bg-slate-950 pb-20 pt-14 sm:pb-24 sm:pt-16" id="contact" aria-labelledby="contact-heading">
	<div class="mx-auto max-w-6xl px-6">
		<div class="js-fade-in max-w-2xl">
			<p class="text-sm font-semibold uppercase tracking-widest text-sky-300">Get in touch</p>
			<h2 id="contact-heading" class="mt-3 text-2xl font-semibold tracking-tight text-slate-100 sm:text-3xl">
				Tell Us About Your {role} Needs
			</h2>
			<p class="mt-4 text-base leading-relaxed text-slate-400">
				Share your scope and requirements â€” we'll match you with vetted {role} candidates fast.
			</p>
		</div>
		<div class="mt-10 grid gap-6 lg:grid-cols-2">
			<ContactForm subject={`LatAm Scalers â€” inquiry (role: ${role})`} defaultInterest={defaultInterest} defaultMessage={`I'm interested in hiring a ${role}.`} />
			<CalendlyInline url={calendlyUrl} title={`Book a call about ${role}`} />
		</div>
	</div>
</section>

<style>
	.js-fade-in {
		opacity: 0;
		transform: translateY(20px);
		transition: opacity 0.35s ease-out, transform 0.35s ease-out;
	}
	.js-fade-in.is-visible {
		opacity: 1;
		transform: translateY(0);
	}
</style>

<script is:inline>
	(function () {
		var els = document.querySelectorAll('.js-fade-in');
		if (!els.length) return;
		var io = new IntersectionObserver(function (entries) {
			entries.forEach(function (e) {
				if (e.isIntersecting) {
					e.target.classList.add('is-visible');
					io.unobserve(e.target);
				}
			});
		}, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
		els.forEach(function (el) { io.observe(el); });
	})();
</script>

